function passwordInputCallback(e){""===e.value?e.classList.remove("punctuation"):e.classList.add("punctuation"),document.body.querySelector("#password-error").style.visibility="hidden"}async function decrypt(e,t){let r=Uint8Array.from(atob(e),e=>e.charCodeAt(0));return new TextDecoder().decode(await window.crypto.subtle.decrypt({name:"AES-GCM",iv:r.slice(16,28)},await window.crypto.subtle.deriveKey({name:"PBKDF2",salt:r.slice(0,16),iterations:1e5,hash:"SHA-256"},await window.crypto.subtle.importKey("raw",new TextEncoder().encode(t),"PBKDF2",!1,["deriveKey"]),{name:"AES-GCM",length:256},!1,["decrypt"]),r.slice(28)))}function _grantAccess(e,t){localStorage.setItem("septv_pwd#"+t,e),decrypt(septv_body,e).then(t=>{document.body.querySelector(".container").outerHTML=t,document.body.classList.remove("main-page"),document.body.classList.add("user-page"),loadReceiptImages(e)},e=>alert("Error:"+e))}function login(){let e=document.body.querySelector("#password-input").value;return checkpw(e,septv_key,t=>{t?_grantAccess(e,document.body.getAttribute("data")):document.body.querySelector("#password-error").style.visibility=null})}function logout(){localStorage.removeItem("septv_pwd#"+document.body.getAttribute("data")),window.location.href="../"}document.addEventListener("DOMContentLoaded",()=>{let e=document.body.getAttribute("data"),t=localStorage.getItem("septv_pwd#"+document.body.getAttribute("data"));function r(){document.body.querySelector("#password-input").addEventListener("keyup",e=>{"Enter"===e.key&&login()}),document.body.querySelector("#password-prompt").style.display=null,document.body.querySelector("#password-form").style.display=null}t?checkpw(t,septv_key,o=>{o?_grantAccess(t,e):(localStorage.removeItem("septv_pwd#"+e),r())}):r()});